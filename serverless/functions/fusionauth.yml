version: 1.0
provider:
  name: openfaas
functions:
  sign-in:
    lang: dotnet-hasura
    handler: ./Softozor.FusionAuth.SignIn
    image: softozor/fusionauth-signin-fn:${IMG_TAG:-latest}
    build_args:
      FUNCTION_NAME: Softozor.FusionAuth.SignIn
    environment:
      AUTH_URL: ${AUTH_URL:-http://fusionauth:9011}
      HASURA_CLAIMS_NAMESPACE: ${HASURA_CLAIMS_NAMESPACE:-https://hasura.io/jwt/claims}
    secrets:
      - auth-secret
      - data-protection-secret
  validate-token:
    lang: dotnet-hasura
    handler: ./Softozor.FusionAuth.TokenValidation
    image: softozor/fusionauth-validate-token-fn:${IMG_TAG:-latest}
    build_args:
      FUNCTION_NAME: Softozor.FusionAuth.TokenValidation
    environment:
      AUTH_URL: ${AUTH_URL:-http://fusionauth:9011}
      HASURA_CLAIMS_NAMESPACE: ${HASURA_CLAIMS_NAMESPACE:-https://hasura.io/jwt/claims}
    secrets:
      - auth-secret
configuration:
  templates:
    - name: dotnet-hasura
      source: https://gitlab.hidora.com/softozor/faas-templates.git